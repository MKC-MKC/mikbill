# –ß—Ç–æ —ç—Ç–æ?

–≠—Ç–æ—Ç —Ñ–∞–π–ª —Å–æ–¥–µ—Ä–∂–∏—Ç –Ω–µ–º–Ω–æ–≥–æ –ø–æ—è—Å–Ω–µ–Ω–∏–π –∏ –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–µ–π –ø—Ä–æ —ç—Ç–æ—Ç SDK: `haikiri/mikbill`

## ‚öôÔ∏è –°—Ç–∞–Ω–¥–∞—Ä—Ç—ã

–ö–æ–¥ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç:

- [PSR-1](https://www.php-fig.org/psr/psr-1/)
- [PSR-4](https://www.php-fig.org/psr/psr-4/)

–ö–æ–¥ –º–æ–∂–µ—Ç –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å PSR-12 –∏ PSR-PER-2, –∏ —ç—Ç–æ —Å–¥–µ–ª–∞–Ω–æ –æ—Å–æ–∑–Ω–∞–Ω–Ω–æ ‚ó°Ãà

## üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

–ü—Ä–æ–µ–∫—Ç –ø–æ—Å—Ç—Ä–æ–µ–Ω –Ω–∞ –æ—Å–Ω–æ–≤–µ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã API MikBiLL —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è.
–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –±—É–¥–µ—Ç –Ω–∞–ø–æ–ª–Ω—è—Ç—å—Å—è –ø–æ –º–µ—Ä–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏, –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π –∏ –æ—Ç–∫–ª–∏–∫–æ–≤.
–ì–æ—Ç–æ–≤—ã–µ –º–µ—Ç–æ–¥—ã –±—É–¥—É—Ç –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω—ã –≤ —Ñ–∞–π–ª–µ `readme.md` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞ –ø–æ—Å–ª–µ —Ä–µ–∞–ª—å–Ω—ã—Ö –æ—Ç–∑—ã–≤–æ–≤.
–ù–µ —Å—Ç–µ—Å–Ω—è–π—Ç–µ—Å—å —Å–æ–æ–±—â–∞—Ç—å –ø—Ä–æ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –º–µ—Ç–æ–¥–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –±—ã–ª–∏ –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω—ã. –ö–æ–Ω—Ç–∞–∫—Ç—ã –≤ `composer.json`.

```plaintext
‚îå API –°—Ç—Ä—É–∫—Ç—É—Ä–∞
‚îú‚îÄ Billing API
‚îÇ  ‚îî‚îÄ Users (100%)
‚îú‚îÄ Cabinet API
‚îÇ  ‚îú‚îÄ Auth (99%)
‚îÇ  ‚îÇ  ‚îú‚îÄ Login (100%)
‚îÇ  ‚îÇ  ‚îî‚îÄ Phone (99% - —Ç—Ä–µ–±—É–µ—Ç—Å—è —Ä–µ–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞)
‚îÇ  ‚îú‚îÄ Tickets
‚îÇ  ‚îú‚îÄ Common
‚îÇ  ‚îú‚îÄ Packet
‚îÇ  ‚îú‚îÄ User (>=80%)
‚îÇ  ‚îÇ  ‚îî‚îÄ Contacts (0%)
‚îÇ  ‚îú‚îÄ Register Hotpost
‚îÇ  ‚îÇ  ‚îú‚îÄ type 1
‚îÇ  ‚îÇ  ‚îî‚îÄ type 2
‚îÇ  ‚îú‚îÄ Payments
‚îÇ  ‚îú‚îÄ Services
‚îÇ  ‚îÇ  ‚îú‚îÄ Turbo
‚îÇ  ‚îÇ  ‚îú‚îÄ Freeze
‚îÇ  ‚îÇ  ‚îú‚îÄ Real IP
‚îÇ  ‚îÇ  ‚îú‚îÄ Credit
‚îÇ  ‚îÇ  ‚îî‚îÄ Change MAC
‚îÇ  ‚îú‚îÄ Subscriptions (100%)
‚îÇ  ‚îÇ  ‚îî‚îÄ Other
‚îÇ  ‚îú‚îÄ Reports
‚îÇ  ‚îú‚îÄ News
‚îÇ  ‚îî‚îÄ Omnicell
```

## üõ† –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã

–¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∞ –Ω–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–∞—Ö –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç:

- –∑–∞–º–µ–Ω—è—Ç—å –ø—Ä–æ–±–ª–µ–º–Ω—ã–µ —á–∞—Å—Ç–∏ –∫–æ–¥–∞ –ø–æ–¥ —Å–≤–æ–∏ –Ω—É–∂–¥—ã;
- —Ä–µ–∞–ª–∏–∑–æ–≤—ã–≤–∞—Ç—å —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö;
- –ø—Ä–∏ —ç—Ç–æ–º –Ω–µ –ª–æ–º–∞—Ç—å –≤—Å—é –±–∏–±–ª–∏–æ—Ç–µ–∫—É.

## üìò –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∏ –ø–æ–º–æ—â—å —Å–æ–æ–±—â–µ—Å—Ç–≤–∞

–ü–æ—á—Ç–∏ –Ω–∞–¥ –∫–∞–∂–¥—ã–º –º–µ—Ç–æ–¥–æ–º –æ—Å—Ç–∞–≤–ª–µ–Ω—ã –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏.

–ù–æ, –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –ø–æ–ª—è –æ–ø–∏—Å–∞–Ω—ã –Ω–µ–ø–æ–ª–Ω–æ, –ª–∏–±–æ –≤–æ–æ–±—â–µ –Ω–µ –æ–ø–∏—Å–∞–Ω—ã, –ø–æ—Ç–æ–º—É —á—Ç–æ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –Ω–∞ –∫–∞–∂–¥–æ–µ –ø–æ–ª–µ –ë–î ‚Äì –Ω–µ—Ç.

–ë—É–¥–µ—Ç –∫—Ä—É—Ç–æ, –µ—Å–ª–∏ —Ç—ã –ø–æ–º–æ–∂–µ—à—å –∑–∞–ø–æ–ª–Ω–∏—Ç—å –ø—Ä–æ–±–µ–ª—ã –∏ –∑–Ω–∞–µ—à—å —á—Ç–æ –∑–∞ —á—Ç–æ –æ—Ç–≤–µ—á–∞–µ—Ç...

–ï—Å–ª–∏ –≤ –∫–∞–∫–æ–º-—Ç–æ –æ–±—ä–µ–∫—Ç–µ –Ω–µ—Ç –Ω—É–∂–Ω–æ–π –º–æ–¥–µ–ª–∏, –Ω–µ—Ç –≤—Ä–µ–º–µ–Ω–∏ –∂–¥–∞—Ç—å –≤–Ω–µ—Å–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π, —Ç—ã –º–æ–∂–µ—à—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:

–ú–µ—Ç–æ–¥: `getAsArray` –≤–µ—Ä–Ω—ë—Ç —Ç–µ–±–µ –ø–æ–ª–Ω—ã–π response –º–∞—Å—Å–∏–≤ –¥–∞–Ω–Ω—ã—Ö –Ω–∞–ø—Ä—è–º—É—é –∏–∑ –∑–∞–ø—Ä–æ—Å–∞.

```php
$method->getAsArray();
```

–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è: [blob/1.0.0/README.md#L169](https://github.com/MKC-MKC/mikbill/blob/1.0.0/README.md?plain=1#L169)

### –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è:

- `InvalidJsonException` ‚Äî –æ—à–∏–±–∫–∞ JSON –∏–ª–∏ –æ—Ç–≤–µ—Ç–∞ –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞
- `InvalidTokenException` ‚Äî –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç —Ç–æ–∫–µ–Ω –æ—Ç –∫–∞–±–∏–Ω–µ—Ç–∞
- `Throwable` ‚Äî –≥–ª—É–±–æ–∫–∞—è –º–µ—Ä–∞ –æ—Ç–ª–æ–≤–∞ –æ—à–∏–±–æ–∫

## üßØ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

–û–±–æ—Ä–∞—á–∏–≤–∞–π –≤—ã–∑–æ–≤—ã –≤ `try-catch` —á—Ç–æ–±—ã –æ—Ç–ª–æ–≤–∏—Ç—å –∏—Å–∫–ª—é—á–µ–Ω–∏—è:

```php
try {
    $response = $MikBiLL->billing->Users()->getUserToken();
} catch (InvalidJsonException $e) {
    // –î–µ–π—Å—Ç–≤–∏—è –ø—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö —Å json-–æ—Ç–≤–µ—Ç–æ–º
} catch (InvalidTokenException $e) {
    // –î–µ–π—Å—Ç–≤–∏—è –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ —Ç–æ–∫–µ–Ω–∞
} catch (\Throwable $e) {
    // –î–µ–π—Å—Ç–≤–∏—è –ø—Ä–∏ –≤—Å–µ—Ö –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –∏—Å–∫–ª—é—á–µ–Ω–∏—è—Ö
    echo $e->getMessage(); # –í—ã–≤–æ–¥–∏–º —Ç–µ–∫—Å—Ç –æ—à–∏–±–∫–∏.
}
```

## üõ† –°–≤–æ—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è sendRequest

–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –∏—Å–ø–æ–ª—å–∑—É–µ–º "—Å–∞–º–æ–ø–∞–ª—å–Ω—É—é" –æ–±—ë—Ä—Ç–∫—É –Ω–∞–¥ curl —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –ø—Ä–æ–∫—Å–∏ –ø–æ –∑–∞–ø—Ä–æ—Å—É, –Ω–æ...
–ï—Å–ª–∏ –Ω–µ —É—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç —Ç–∞–∫–æ–π —Å–∫—É–¥–Ω—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –∏ '–Ω–∏–∫—É–¥—ã—à–Ω–∞—è' –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫, —Ç—ã –º–æ–∂–µ—à—å —Å–¥–µ–ª–∞—Ç—å —Å–≤–æ–π —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π –∫–ª–∞—Å—Å!
–Ø –¥–∞–∂–µ –ø–æ–∫–∞–∂—É –ø—Ä–∏–º–µ—Ä –∫–∞–∫ —Å–¥–µ–ª–∞—Ç—å —Å–≤–æ–π –∫–ª–∞—Å—Å –∏ –≤—ã–ø–æ–ª–Ω—è—Ç—å –∫ –Ω–µ–º—É –∑–∞–ø—Ä–æ—Å—ã ‚ù§Ô∏è

```php
<?php

namespace App; # –û–±—Ä–∞—Ç–∏ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ —Å–≤–æ–π namespace

use Haikiri\MikBiLL\MikBiLLApiAbstract;

class MyCustomMBClass extends MikBiLLApiAbstract
{

    public function sendRequest(string $uri, string $method = "POST", array $params = [], bool $sign = false, ?string $token = null): ?array
    {
        #  –ó–¥–µ—Å—å —Ç—ã –º–æ–∂–µ—à—å –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –º–µ—Ç–æ–¥ sendRequest, —á—Ç–æ–±—ã –∏–∑–º–µ–Ω–∏—Ç—å –ª–æ–≥–∏–∫—É –æ—Ç–ø—Ä–∞–≤–∫–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ API MikBiLL.
        #  –ù–∞–ø—Ä–∏–º–µ—Ä, —Ç—ã –º–æ–∂–µ—à—å –ø–æ–¥–∫–ª—é—á–∏—Ç—å –¥—Ä—É–≥—É—é –±–∏–±–ª–∏–æ—Ç–µ–∫—É –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –∑–∞–ø—Ä–æ—Å–æ–≤.
        #  –û–±—Ä–∞—Ç–∏ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ –ø–æ—Å–ª–µ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –º–µ—Ç–æ–¥–∞ sendRequest, —Ç—ã –ø–æ—Ç–µ—Ä—è–µ—à—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–æ–∫—Å–∏.
        #  –° –¥—Ä—É–≥–æ–π —Å—Ç–æ—Ä–æ–Ω—ã, —Ç—ã –≤ –ø—Ä–∞–≤–µ —Å–∞–º —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø—Ä–æ–∫—Å–∏ –≤ —ç—Ç–æ–º –º–µ—Ç–æ–¥–µ, –µ—Å–ª–∏ –≤ —ç—Ç–æ–º –≤–æ–æ–±—â–µ –µ—Å—Ç—å –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å.
        #  –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Å–≤–æ–µ–≥–æ –Ω–æ–≤–æ–≥–æ –∫–ª–∞—Å—Å–∞:
        #  $MikBiLLCustom = new App\MyCustomMBClass(); # –û–±—Ä–∞—Ç–∏ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ —Å–≤–æ–π namespace.
        #  $token = $MikBiLLCustom->billing->Users()->getUserToken(); # –ü—Ä–æ—Å—Ç–æ–µ –ø–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞.
        #  $MikBiLLCustom->setUserToken($token); # –°–æ—Ö—Ä–∞–Ω–∏–ª–∏ —Ç–æ–∫–µ–Ω.
    }

}
```

–î–∞, —Ç–µ–ø–µ—Ä—å —Ç—ã –¥–æ–ª–∂–µ–Ω –æ–±—Ä–∞—â–∞—Ç—å—Å—è –∫ –Ω–æ–≤–æ–º—É –∫–ª–∞—Å—Å—É, –∞ –Ω–µ –∫ `Haikiri\MikBiLL\MikBiLLApi()`.

```php
$MikBiLL = new App\MyCustomMBClass();
$MikBiLL->billing->Users()->getUserToken();
```

## ‚úÖ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ —Å–≤–æ–µ–≥–æ –∫–ª–∞—Å—Å–∞

- –°–º–æ–∂–µ—à—å —Å–∞–º —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ –≥–æ–¥–∞–º–∏ request —Ä–µ—à–µ–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É—è `guzzle`, `symfony/http-client` –∏ –¥—Ä.
- –ü–æ–ª–Ω–∞—è —Å–≤–æ–±–æ–¥–∞ –¥–µ–π—Å—Ç–≤–∏–π: –º–æ–∂–µ—à—å –∫–∞–∫ —É–≥–æ–¥–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –∫–ª–∞—Å—Å–∞–º –±–∏–ª–ª–∏–Ω–≥–∞ –∏ –∫–∞–±–∏–Ω–µ—Ç–∞.
- –ò –≤–æ–æ–±—â–µ ‚Äì —Ö–æ–∑—è–∏–Ω –±–∞—Ä–∏–Ω...

## üîª –ú–∏–Ω—É—Å—ã —Å–≤–æ–µ–≥–æ –∫–ª–∞—Å—Å–∞

- –ü—Ä–∏–¥—ë—Ç—Å—è –ø–æ–≤–æ–∑–∏—Ç—å—Å—è –µ—Å–ª–∏ –Ω–µ—Ç –æ–ø—ã—Ç–∞ —Å —Å–æ–∑–¥–∞–Ω–∏–µ–º –∑–∞–ø—Ä–æ—Å–æ–≤.
- –°—Ç—Ä–æ–≥–∞—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ –∏ –∞–±—Å—Ç—Ä–∞–∫—Ç–µ –¥–ª—è –º–µ—Ç–æ–¥–∞ sendRequest.

## üí¨ –ù–∞–ø–æ—Å–ª–µ–¥–æ–∫:

–ò–∑–Ω–∞—á–∞–ª—å–Ω–æ, –º–µ—Ç–æ–¥ `sendRequest` –æ—Å–Ω–æ–≤–∞–Ω –Ω–∞ –∏–¥–µ–µ –∏–∑ `kagatan/mb-client-api`, –Ω–æ —Ç–∞–º –æ–Ω `private`,
–¥–∞–∂–µ –Ω–µ `protected`, –∏ —ç—Ç–æ –ª–æ–º–∞–µ—Ç –≤—Å—é –ø—Ä–µ–ª–µ—Å—Ç—å composer...
–ó–¥–µ—Å—å –∂–µ `sendRequest` ‚Äì –ø—É–±–ª–∏—á–Ω—ã–π, –∞–±—Å—Ç—Ä–∞–∫—Ç–Ω—ã–π –∏ –Ω–∞ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞—Ö. –ò–¥–µ—è –æ–¥–Ω–∞, –∞ —Ü–µ–ª–∏ —Ä–∞–∑–Ω—ã–µ. –†–∞—Å—à–∏—Ä—è–π—Ç–µ—Å—å –∫–∞–∫ —Ö–æ—Ç–∏—Ç–µ ‚ó°Ãà

> –ï—Å–ª–∏ —Ö–æ—á–µ—à—å –¥–æ–ø–æ–ª–Ω–∏—Ç—å –±–∏–±–ª–∏–æ—Ç–µ–∫—É ‚Äî –Ω–∞–ø–∏—à–∏ –ø–æ –∫–æ–Ω—Ç–∞–∫—Ç–∞–º –≤ `composer.json`.
